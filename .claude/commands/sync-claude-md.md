<!-- @description Re-analyzes your project and updates CLAUDE.md to reflect current state. -->

# Sync CLAUDE.md

Re-analyze the project and update CLAUDE.md to reflect current state.

Run this when your project has changed significantly:
- Added a major framework or dependency
- Changed npm scripts or build commands
- Restructured the project
- Switched databases or services

## Step 1: Check for Captured Manual Edits

Before regenerating, check `.claude/feedback/FEEDBACK.md` for any "Manual Edits (auto-captured)" sections. These are edits users made directly to CLAUDE.md that were migrated by the guard hook. Review and incorporate relevant guidance into your regeneration.

## Step 2: Re-analyze the Project

Scan for current project indicators:

**Package/Config Files:**
- `package.json` → dependencies, scripts
- `requirements.txt` / `pyproject.toml` → Python deps
- `Cargo.toml`, `go.mod`, `Gemfile`, etc.

**Framework Indicators:**
- Config files (next.config.*, vite.config.*, etc.)
- Directory structure (app/, src/, etc.)

**Infrastructure:**
- Docker, Terraform, CI/CD configs

## Step 3: Update CLAUDE.md

CLAUDE.md uses markers to identify auto-generated content. Include a timestamp for the guard hook:

```markdown
<!-- AUTO-GENERATED BY /autoconfig at {TIMESTAMP} UTC — Do not edit. Use .claude/feedback/ for corrections. -->
...content...
<!-- END AUTO-GENERATED at {TIMESTAMP} UTC — Use .claude/feedback/ for corrections. -->
```

**IMPORTANT:** Always replace `{TIMESTAMP}` with the CURRENT UTC time in format `YYYY-MM-DD HH:MM:SS` (e.g., `2026-01-14 16:30:45`). This refreshes the guard hook timestamp so it knows this is a fresh system edit.

**Only regenerate content between these markers.** Content outside markers will be removed on next sync - users should add feedback to `.claude/feedback/FEEDBACK.md` instead.

Compare detected state with current CLAUDE.md and update:

1. **Project name** — if changed
2. **Tech stack** — new frameworks, languages, databases
3. **Commands** — new/changed npm scripts, build commands
4. **Conventions** — if project structure changed

**Always include within markers:**
- The `## Retro` section pointer
- The `## Team Feedback` section pointer

## Step 4: Confirm Changes

Show the user what changed in CLAUDE.md before finishing.

## Guidelines

- **Respect markers**: Only regenerate content between AUTO-GENERATED markers
- **Be conservative**: Only update sections that actually changed
- **Keep it tight**: CLAUDE.md should stay concise
