<!-- @description The command you just ran. Analyzes your project and populates CLAUDE.md with real context. Re-run anytime your stack changes. -->

# Autoconfig

Analyze this project and configure Claude Code with real context.

## Step 1: Detect Environment

**Operating System:**
Check the platform and note it for command syntax:
- Windows â†’ use `del`, `rmdir`, backslashes, `.cmd`/`.ps1` scripts
- macOS/Linux â†’ use `rm`, `mkdir -p`, forward slashes, `.sh` scripts

Include this in CLAUDE.md so all commands use the correct syntax.

## Step 2: Scan the Project

Look for these indicators to understand the project:

**Package/Config Files:**
- `package.json` â†’ Node.js, npm scripts, dependencies
- `requirements.txt` / `pyproject.toml` / `setup.py` â†’ Python
- `Cargo.toml` â†’ Rust
- `go.mod` â†’ Go
- `Gemfile` â†’ Ruby
- `pom.xml` / `build.gradle` â†’ Java
- `*.csproj` / `*.sln` â†’ .NET
- `composer.json` â†’ PHP

**Framework Indicators:**
- `next.config.*` / `app/` directory â†’ Next.js
- `vite.config.*` â†’ Vite
- `angular.json` â†’ Angular
- `svelte.config.*` â†’ Svelte
- `remix.config.*` â†’ Remix
- `nuxt.config.*` â†’ Nuxt
- `django` in imports â†’ Django
- `flask` in imports â†’ Flask
- `fastapi` in imports â†’ FastAPI
- `express` in dependencies â†’ Express
- `rails` / `Gemfile` with rails â†’ Rails
- `laravel` â†’ Laravel

**Testing Frameworks:**
- `jest.config.*` / `@jest` in deps â†’ Jest
- `vitest.config.*` â†’ Vitest
- `pytest.ini` / `conftest.py` â†’ Pytest
- `*_test.go` files â†’ Go testing
- `*_spec.rb` files â†’ RSpec
- `cypress/` or `playwright/` â†’ E2E testing

**Infrastructure:**
- `Dockerfile` / `docker-compose.*` â†’ Docker
- `*.tf` files â†’ Terraform
- `k8s/` or `kubernetes/` â†’ Kubernetes
- `.github/workflows/` â†’ GitHub Actions
- `serverless.yml` â†’ Serverless Framework

## Step 3: Populate CLAUDE.md

Focus on what Claude Code actually needs to work effectively. Claude can explore the codebase itself â€” don't document what it can discover.

**Wrap content in markers** so `/sync-claude-md` knows what's auto-generated:

```markdown
<!-- AUTO-GENERATED BY /autoconfig â€” Do not edit. Use .claude/feedback/ for corrections. -->

# Project Name
...content...

<!-- END AUTO-GENERATED -->
```

**Always include:**
- **Project name + one-liner**: What is this thing?
- **Tech stack**: Runtime, framework, database, key services (so Claude uses correct patterns)
- **Commands**: How to run, test, build, deploy â€” Claude needs these to execute tasks
- **Non-obvious conventions**: Multi-schema databases, monorepo structure, unusual patterns Claude wouldn't infer

**Include if relevant:**
- **Deployment flow**: If non-standard or involves multiple steps
- **Key architectural decisions**: Only if Claude would make wrong assumptions without them

**Skip these â€” Claude can discover them:**
- Detailed project structure trees (Claude can run `ls` or `tree`)
- Exhaustive route/endpoint lists (Claude can grep)
- File-by-file descriptions (Claude can read files)
- Database model lists (Claude can read schema files)

**Keep it tight.** A 30-line CLAUDE.md that hits the essentials beats a 200-line doc Claude has to parse every session.

**Always end with:**
```markdown
## Team Feedback
See `.claude/feedback/` for corrections and guidance from the team.
```

This pointer persists across autoconfig runs and directs Claude to team-maintained content.

## Step 4: Create Rules Directory

Create an empty `.claude/rules/` directory. Do not create any subdirectories or rule files.

Rules are path-scoped context files that load automatically when Claude works on matching files. Effective rules require deep understanding of your codebase patterns, team conventions, and quality goals â€” they should be crafted intentionally, not auto-generated.

## Step 5: Configure Settings

Update `.claude/settings.json` using the official schema.

### Deny Patterns (files Claude shouldn't read/write)

Use `Read()` for blocking reads, `Edit()` for blocking writes:

**Always deny (security):**
```
Read(./.env)
Read(./.env.*)
Read(./secrets/**)
Edit(./.env)
Edit(./.env.*)
```

**Often deny (generated/vendor):**
```
Edit(./node_modules/**)
Edit(./dist/**)
Edit(./.git/**)
```

### Allow Patterns (auto-approve without prompting)

Use `Bash()` patterns with prefix matching:

```
Bash(npm run test:*)
Bash(npm run lint:*)
Bash(npm run build)
```

### Environment Variables

Set session-level env vars:

```json
{
  "env": {
    "NODE_ENV": "development"
  }
}
```

**Keep it minimal** â€” only include patterns that actually exist in this project.

## Guidelines

- Replace ALL placeholder content with real values from THIS project
- Delete sections that don't apply â€” no empty stubs
- Optimize for Claude's efficiency, not human documentation
- When uncertain, leave it out â€” Claude can ask or explore

## Step 6: Update the Guide

After populating CLAUDE.md, update the guide's file preview to show the actual content:

1. Open `.claude/guide/autoconfig.guide.html`
2. Find the `fileContents` JavaScript object (search for `'claude-md':`)
3. Replace the `content` value with the actual CLAUDE.md content you just generated
4. Use template literal syntax and escape any backticks in the content

This ensures double-clicking CLAUDE.md in the guide shows the real generated content.

## After Completion

### Windows Cleanup

On Windows, a `nul` file may be accidentally created when commands redirect to null. Before finishing, check for and delete this file if it exists:

```
del nul 2>nul
```

This is safe to run even if the file doesn't exist.

### Open Guide & Finale

Open the interactive guide in the user's browser:

- macOS: `open .claude/guide/autoconfig.guide.html`
- Linux: `xdg-open .claude/guide/autoconfig.guide.html`
- Windows: `start .claude/guide/autoconfig.guide.html`

Then output a celebratory finale message:

```
---

âœ… Setup complete! Your Claude Code environment is ready.

ðŸ“– The interactive guide is now open â€” it walks through everything that was configured.
```